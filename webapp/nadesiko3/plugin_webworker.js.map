{"version":3,"file":"plugin_webworker.js","mappings":"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","sources":["webpack://nadesiko3/./src/plugin_webworker.mjs"],"sourcesContent":["// @ts-nocheck\r\nconst PluginWebWorker = {\r\n  '初期化': {\r\n    type: 'func',\r\n    josi: [],\r\n    pure: true,\r\n    fn: function (sys) {\r\n      sys._webworker = {\r\n        setNakoHandler: function (work) {\r\n          work.onmessage = (event) => {\r\n            const data = event.data || { type: '', data: '' }\r\n            const type = data.type || ''\r\n            const value = data.data || ''\r\n            switch (type) {\r\n              case 'output':\r\n                if (work.onoutput) {\r\n                  work.onoutput.apply(sys, [value, event])\r\n                }\r\n                break\r\n              case 'data':\r\n                if (work.ondata) {\r\n                  work.ondata.apply(sys, [value, event])\r\n                }\r\n                break\r\n              case 'error':\r\n                sys.logger.error(value.noColor)\r\n                break\r\n            }\r\n          }\r\n          work.onerror = (event) => {\r\n            const e = new Error(typeof event.message !== 'undefined' ? event.message : 'no message')\r\n            sys.logger.error(e)\r\n          }\r\n          work.onerrormessage = (event) => {\r\n            const e = new Error(typeof event.message !== 'undefined' ? event.message : 'no message')\r\n            sys.logger.error(e)\r\n          }\r\n        },\r\n        inWorker: () => {\r\n          // eslint-disable-next-line no-undef\r\n          return typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope\r\n        },\r\n        getBaseUrlFromTag: () => {\r\n          if (!self.document) { return '' }\r\n          const pluginName = 'plugin_webworker.js'\r\n          let path = location.pathname\r\n          if (path.substr(path.length - 1, 1) !== '/') {\r\n            const paths = path.split('/')\r\n            path = paths.slice(paths.length - 1, 1).join('/') & '/'\r\n          }\r\n          const scripts = document.querySelectorAll('script')\r\n          for (let i = 0; i < scripts.length; i++) {\r\n            const script = scripts[i]\r\n            let src = script.src || ''\r\n            const index = src.indexOf(pluginName)\r\n            if (index >= 0) {\r\n              if (src.length - index === pluginName.length ||\r\n                  '?&#'.indexOf(src.substr(index + pluginName.length, 1)) >= 0) {\r\n                src = src.substring(0, index)\r\n                if (src.substring(0, 1) === '/') {\r\n                  // スクリプトソースはorigin無しの絶対パス\r\n                  return location.origin + src\r\n                }\r\n                if (/^[a-zA-Z]+:\\/\\//.test(src)) {\r\n                  // スクリプトソースは絶対URI\r\n                  return src\r\n                }\r\n                // スクリプトソースはorigin無しの相対パス\r\n                return location.origin + path + src\r\n              }\r\n            }\r\n          }\r\n          // スクリプトソースが見つからなかったのでドキュメントのURIを返す\r\n          return location.origin + path\r\n        }\r\n      }\r\n      sys.__v0['ワーカーURL'] = sys._webworker.getBaseUrlFromTag()\r\n    }\r\n  },\r\n  // @イベント定数\r\n  '対象イベント': { type: 'const', value: '' }, // @たいしょういべんと\r\n  '受信データ': { type: 'const', value: '' }, // @たいしょういべんと\r\n\r\n  'ワーカーURL': { type: 'const', value: '' }, // @わーかーURL\r\n  'ワーカーURL設定': { // @なでしこv3のファイルのあるURLを設定 // @わーかーURLせってい\r\n    type: 'func',\r\n    josi: [['に', 'へ', 'と']],\r\n    pure: true,\r\n    fn: function (url, sys) {\r\n      if (url && url.substring(url.length - 1) !== '/') {\r\n        url += '/'\r\n      }\r\n      sys.__v0['ワーカーURL'] = url\r\n    },\r\n    return_none: true\r\n  },\r\n\r\n  // @NAKOワーカー\r\n  'ワーカー起動': { // @指定したURLでWebWorkerを起動する。ワーカオブジェクトを返す。 // @わーかーきどう\r\n    type: 'func',\r\n    josi: [['で', 'を', 'の']],\r\n    pure: true,\r\n    fn: function (url, sys) {\r\n      return new Worker(url)\r\n    },\r\n    return_none: false\r\n  },\r\n  'ワーカーJS起動': { // @指定したJavascriptのソースでWebWorkerを起動する。ワーカオブジェクトを返す。 // @わーかーJSきどう\r\n    type: 'func',\r\n    josi: [['で', 'を', 'の']],\r\n    pure: true,\r\n    fn: function (src, sys) {\r\n      const blob = new Blob([src], { type: 'application/javascript' })\r\n      const url = URL.createObjectURL(blob)\r\n      return new Worker(url)\r\n    },\r\n    return_none: false\r\n  },\r\n  'NAKOワーカー起動': { // @指定したなでしこ３のWebWorkerを起動する。ワーカオブジェクトを返す。 // @NAKOわーかーきどう\r\n    type: 'func',\r\n    josi: [['で']],\r\n    isVariableJosi: true,\r\n    pure: true,\r\n    fn: function (plugins, sys) {\r\n      let url\r\n      if (typeof sys === 'undefined') { sys = plugins; plugins = undefined }\r\n      if (plugins !== undefined) {\r\n        if (!(plugins instanceof Array)) {\r\n          throw new Error('プラグインはファイル名を配列で指定してください')\r\n        }\r\n        const baseurl = sys.__v0['ワーカーURL']\r\n        let code = `importScripts('${baseurl}wnako3webworker.js')\\n`\r\n        const l = plugins.length\r\n        let i\r\n        for (i = 0; i < l; i++) {\r\n          code += `importScripts('${baseurl}${plugins[i]}')\\n`\r\n        }\r\n        const blob = new Blob([code], { type: 'application/javascript' })\r\n        url = URL.createObjectURL(blob)\r\n      } else {\r\n        url = sys.__v0['ワーカーURL'] + 'wnako3webworker.js'\r\n      }\r\n      const myWorker = new Worker(url)\r\n      if (myWorker) {\r\n        sys._webworker.setNakoHandler(myWorker)\r\n      }\r\n      return myWorker\r\n    },\r\n    return_none: false\r\n  },\r\n  'NAKOワーカーハンドラ設定': { // @ワーカーにNAKOワーカーのための設定を行う。 // @NAKOわーかーはんどらせってい\r\n    type: 'func',\r\n    josi: [['に', 'へ', 'の']],\r\n    pure: true,\r\n    fn: function (work, sys) {\r\n      sys._webworker.setNakoHandler(work)\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカーデータ受信時': { // @無名関数Fでなでしこv3エンジンに対してワーカーメッセージによりデータを受信した時に実行するイベントを設定。『受信データ』に受信したデータ。『対象イベント』にイベント引数。 // @NAKOわーかーでーたじゅしんしたとき\r\n    type: 'func',\r\n    josi: [['で'], ['から']],\r\n    isVariableJosi: true,\r\n    pure: false,\r\n    fn: function (func, work, sys) {\r\n      if (typeof sys === 'undefined') { sys = work; work = self }\r\n      func = sys.__findVar(func, null) // 文字列指定なら関数に変換\r\n      work.ondata = (data, e) => {\r\n        sys.__v0['受信データ'] = data\r\n        sys.__v0['対象イベント'] = e\r\n        return func(e, sys)\r\n      }\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカー表示時': { // @無名関数Fでなでしこv3エンジンに対してワーカーメッセージにより表示データを受信した時に実行するイベントを設定。『受信データ』に表示しようとしたデータ。『対象イベント』にイベント引数。 // @NAKOわーかーひょうじしたとき\r\n    type: 'func',\r\n    josi: [['で'], ['から']],\r\n    pure: false,\r\n    fn: function (func, work, sys) {\r\n      func = sys.__findVar(func, null) // 文字列指定なら関数に変換\r\n      work.onoutput = (data, e) => {\r\n        sys.__v0['受信データ'] = data\r\n        sys.__v0['対象イベント'] = e\r\n        return func(e, sys)\r\n      }\r\n    },\r\n    return_none: true\r\n  },\r\n  'ワーカーメッセージ受信時': { // @無名関数Fでworkに対してメッセージを受信した時に実行するイベントを設定。『受信データ』に受信したデータ。『対象イベント』にイベント引数。 // @わーかーめっせーじじゅしんしたとき\r\n    type: 'func',\r\n    josi: [['で'], ['から']],\r\n    isVariableJosi: true,\r\n    pure: false,\r\n    fn: function (func, work, sys) {\r\n      if (typeof sys === 'undefined') { sys = work; work = self }\r\n      func = sys.__findVar(func, null) // 文字列指定なら関数に変換\r\n      work.onmessage = (e) => {\r\n        sys.__v0['受信データ'] = e.data\r\n        sys.__v0['対象イベント'] = e\r\n        return func(e, sys)\r\n      }\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカープログラム起動': { // @WORKERに固有の形式でプログラムの転送と実行行う。 // @NAKOわーかーぷろぐらむきどう\r\n    type: 'func',\r\n    josi: [['に', 'で'], ['を']],\r\n    pure: true,\r\n    fn: function (work, data, sys) {\r\n      const msg = {\r\n        type: 'run',\r\n        data: sys.__modName + '__' + data\r\n      }\r\n      work.postMessage(msg)\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカーリセット': { // @WORKERに固有の形式でプログラムの転送と実行行う。 // @わーかーりせっと\r\n    type: 'func',\r\n    josi: [['を']],\r\n    pure: true,\r\n    fn: function (work, sys) {\r\n      const msg = {\r\n        type: 'reset',\r\n        data: ''\r\n      }\r\n      work.postMessage(msg)\r\n    },\r\n    return_none: true\r\n  },\r\n  'ワーカー終了': { // @WORKERを終了する。 // @わーかーしゅうりょう\r\n    type: 'func',\r\n    josi: [['を']],\r\n    isVariableJosi: true,\r\n    pure: true,\r\n    fn: function (work, sys) {\r\n      if (typeof sys === 'undefined') { sys = work; work = self }\r\n      work.terminate()\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカー終了': { // @WORKERを終了する。 // @NAKOわーかーしゅうりょう\r\n    type: 'func',\r\n    josi: [['を']],\r\n    isVariableJosi: true,\r\n    pure: true,\r\n    fn: function (work, sys) {\r\n      if (typeof sys === 'undefined') {\r\n        self.close()\r\n        return\r\n      }\r\n      const msg = {\r\n        type: 'close',\r\n        data: ''\r\n      }\r\n      work.postMessage(msg)\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカーデータ送信': { // @WORKERに固有の形式でデータを送信する。 // @NAKOわーかーでーたそうしん\r\n    type: 'func',\r\n    josi: [['を'], ['に', 'へ']],\r\n    isVariableJosi: true,\r\n    pure: true,\r\n    fn: function (data, work, sys) {\r\n      if (typeof sys === 'undefined') { sys = work; work = self }\r\n      const msg = {\r\n        type: 'data',\r\n        data: data\r\n      }\r\n      work.postMessage(msg)\r\n    },\r\n    return_none: true\r\n  },\r\n  'ワーカーメッセージ送信': { // @WORKERにメッセージを送信する。 // @わーかーめっせーじそうしん\r\n    type: 'func',\r\n    josi: [['を'], ['に', 'へ']],\r\n    isVariableJosi: true,\r\n    pure: true,\r\n    fn: function (msg, work, sys) {\r\n      if (typeof sys === 'undefined') { sys = work; work = self }\r\n      work.postMessage(msg)\r\n    },\r\n    return_none: true\r\n  },\r\n  'NAKOワーカー転送': { // @WORKERにユーザー定義関数またはユーザ定義のグローバル変数を転送する。 // @NAKOわーかーてんそう\r\n    type: 'func',\r\n    josi: [['を'], ['に', 'へ']],\r\n    isVariableJosi: true,\r\n    pure: false,\r\n    fn: function (datas, work, sys) {\r\n      if (typeof sys === 'undefined') { sys = work; work = self }\r\n      const obj = []\r\n      if (typeof datas === 'string') { datas = [datas] }\r\n      datas.forEach(data => {\r\n        data = sys.__modName + '__' + data\r\n        if (typeof sys.__varslist[2][data] !== 'undefined') {\r\n          obj.push({\r\n            type: 'val',\r\n            name: data,\r\n            content: sys.__varslist[2][data]\r\n          })\r\n        } else\r\n        if (typeof sys.__varslist[1][data] !== 'undefined') {\r\n          obj.push({\r\n            type: 'func',\r\n            name: data,\r\n            content: {\r\n              meta: sys.gen.nakoFuncList[data],\r\n              func: Object.assign({}, sys.compiler.funclist[data], { fn: null })\r\n            }\r\n          })\r\n        } else {\r\n          console.error('指定した名前のユーザ関数もしくはグローバル変数がありません:' + data)\r\n          throw new Error('指定した名前のユーザ関数もしくはグローバル変数がありません:' + data)\r\n        }\r\n      })\r\n      if (obj.length > 0) {\r\n        const msg = {\r\n          type: 'trans',\r\n          data: obj\r\n        }\r\n        work.postMessage(msg)\r\n      }\r\n    },\r\n    return_none: true\r\n  }\r\n}\r\n\r\nexport default PluginWebWorker\r\n\r\nif (typeof (navigator) === 'object' && typeof (navigator.nako3) === 'object') {\r\n  navigator.nako3.addPluginObject('PluginWebWorker', PluginWebWorker)\r\n}\r\n\r\n"],"names":["PluginWebWorker","type","josi","pure","fn","sys","_webworker","setNakoHandler","work","onmessage","event","data","value","onoutput","apply","ondata","logger","error","noColor","onerror","e","Error","message","onerrormessage","inWorker","WorkerGlobalScope","self","getBaseUrlFromTag","document","pluginName","path","location","pathname","substr","length","paths","split","slice","join","scripts","querySelectorAll","i","src","index","indexOf","substring","origin","test","__v0","url","return_none","Worker","blob","Blob","URL","createObjectURL","isVariableJosi","plugins","undefined","Array","baseurl","code","l","myWorker","func","__findVar","msg","__modName","postMessage","terminate","close","datas","obj","forEach","__varslist","push","name","content","console","meta","gen","nakoFuncList","Object","assign","compiler","funclist","navigator","nako3","addPluginObject"],"sourceRoot":""}