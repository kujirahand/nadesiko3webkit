{"version":3,"file":"plugin_webworker.js","mappings":"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","sources":["webpack://nadesiko3/./src/plugin_webworker.mjs"],"sourcesContent":["// @ts-nocheck\nconst PluginWebWorker = {\n  '初期化': {\n    type: 'func',\n    josi: [],\n    pure: true,\n    fn: function (sys) {\n      sys._webworker = {\n        setNakoHandler: function (work) {\n          work.onmessage = (event) => {\n            const data = event.data || { type: '', data: '' }\n            const type = data.type || ''\n            const value = data.data || ''\n            switch (type) {\n              case 'output':\n                if (work.onoutput) {\n                  work.onoutput.apply(sys, [value, event])\n                }\n                break\n              case 'data':\n                if (work.ondata) {\n                  work.ondata.apply(sys, [value, event])\n                }\n                break\n              case 'error':\n                sys.logger.error(value.noColor)\n                break\n            }\n          }\n          work.onerror = (event) => {\n            const e = new Error(typeof event.message !== 'undefined' ? event.message : 'no message')\n            sys.logger.error(e)\n          }\n          work.onerrormessage = (event) => {\n            const e = new Error(typeof event.message !== 'undefined' ? event.message : 'no message')\n            sys.logger.error(e)\n          }\n        },\n        inWorker: () => {\n          // eslint-disable-next-line no-undef\n          return typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope\n        },\n        getBaseUrlFromTag: () => {\n          if (!self.document) { return '' }\n          const pluginName = 'plugin_webworker.js'\n          let path = location.pathname\n          if (path.substr(path.length - 1, 1) !== '/') {\n            const paths = path.split('/')\n            path = paths.slice(paths.length - 1, 1).join('/') & '/'\n          }\n          const scripts = document.querySelectorAll('script')\n          for (let i = 0; i < scripts.length; i++) {\n            const script = scripts[i]\n            let src = script.src || ''\n            const index = src.indexOf(pluginName)\n            if (index >= 0) {\n              if (src.length - index === pluginName.length ||\n                  '?&#'.indexOf(src.substr(index + pluginName.length, 1)) >= 0) {\n                src = src.substring(0, index)\n                if (src.substring(0, 1) === '/') {\n                  // スクリプトソースはorigin無しの絶対パス\n                  return location.origin + src\n                }\n                if (/^[a-zA-Z]+:\\/\\//.test(src)) {\n                  // スクリプトソースは絶対URI\n                  return src\n                }\n                // スクリプトソースはorigin無しの相対パス\n                return location.origin + path + src\n              }\n            }\n          }\n          // スクリプトソースが見つからなかったのでドキュメントのURIを返す\n          return location.origin + path\n        }\n      }\n      sys.__v0['ワーカーURL'] = sys._webworker.getBaseUrlFromTag()\n    }\n  },\n  // @イベント定数\n  '対象イベント': { type: 'const', value: '' }, // @たいしょういべんと\n  '受信データ': { type: 'const', value: '' }, // @たいしょういべんと\n\n  'ワーカーURL': { type: 'const', value: '' }, // @わーかーURL\n  'ワーカーURL設定': { // @なでしこv3のファイルのあるURLを設定 // @わーかーURLせってい\n    type: 'func',\n    josi: [['に', 'へ', 'と']],\n    pure: true,\n    fn: function (url, sys) {\n      if (url && url.substring(url.length - 1) !== '/') {\n        url += '/'\n      }\n      sys.__v0['ワーカーURL'] = url\n    },\n    return_none: true\n  },\n\n  // @NAKOワーカー\n  'ワーカー起動': { // @指定したURLでWebWorkerを起動する。ワーカオブジェクトを返す。 // @わーかーきどう\n    type: 'func',\n    josi: [['で', 'を', 'の']],\n    pure: true,\n    fn: function (url, sys) {\n      return new Worker(url)\n    },\n    return_none: false\n  },\n  'ワーカーJS起動': { // @指定したJavascriptのソースでWebWorkerを起動する。ワーカオブジェクトを返す。 // @わーかーJSきどう\n    type: 'func',\n    josi: [['で', 'を', 'の']],\n    pure: true,\n    fn: function (src, sys) {\n      const blob = new Blob([src], { type: 'application/javascript' })\n      const url = URL.createObjectURL(blob)\n      return new Worker(url)\n    },\n    return_none: false\n  },\n  'NAKOワーカー起動': { // @指定したなでしこ３のWebWorkerを起動する。ワーカオブジェクトを返す。 // @NAKOわーかーきどう\n    type: 'func',\n    josi: [['で']],\n    isVariableJosi: true,\n    pure: true,\n    fn: function (plugins, sys) {\n      let url\n      if (typeof sys === 'undefined') { sys = plugins; plugins = undefined }\n      if (plugins !== undefined) {\n        if (!(plugins instanceof Array)) {\n          throw new Error('プラグインはファイル名を配列で指定してください')\n        }\n        const baseurl = sys.__v0['ワーカーURL']\n        let code = `importScripts('${baseurl}wnako3webworker.js')\\n`\n        const l = plugins.length\n        let i\n        for (i = 0; i < l; i++) {\n          code += `importScripts('${baseurl}${plugins[i]}')\\n`\n        }\n        const blob = new Blob([code], { type: 'application/javascript' })\n        url = URL.createObjectURL(blob)\n      } else {\n        url = sys.__v0['ワーカーURL'] + 'wnako3webworker.js'\n      }\n      const myWorker = new Worker(url)\n      if (myWorker) {\n        sys._webworker.setNakoHandler(myWorker)\n      }\n      return myWorker\n    },\n    return_none: false\n  },\n  'NAKOワーカーハンドラ設定': { // @ワーカーにNAKOワーカーのための設定を行う。 // @NAKOわーかーはんどらせってい\n    type: 'func',\n    josi: [['に', 'へ', 'の']],\n    pure: true,\n    fn: function (work, sys) {\n      sys._webworker.setNakoHandler(work)\n    },\n    return_none: true\n  },\n  'NAKOワーカーデータ受信時': { // @無名関数Fでなでしこv3エンジンに対してワーカーメッセージによりデータを受信した時に実行するイベントを設定。『受信データ』に受信したデータ。『対象イベント』にイベント引数。 // @NAKOわーかーでーたじゅしんしたとき\n    type: 'func',\n    josi: [['で'], ['から']],\n    isVariableJosi: true,\n    pure: false,\n    fn: function (func, work, sys) {\n      if (typeof sys === 'undefined') { sys = work; work = self }\n      func = sys.__findVar(func, null) // 文字列指定なら関数に変換\n      work.ondata = (data, e) => {\n        sys.__v0['受信データ'] = data\n        sys.__v0['対象イベント'] = e\n        return func(e, sys)\n      }\n    },\n    return_none: true\n  },\n  'NAKOワーカー表示時': { // @無名関数Fでなでしこv3エンジンに対してワーカーメッセージにより表示データを受信した時に実行するイベントを設定。『受信データ』に表示しようとしたデータ。『対象イベント』にイベント引数。 // @NAKOわーかーひょうじしたとき\n    type: 'func',\n    josi: [['で'], ['から']],\n    pure: false,\n    fn: function (func, work, sys) {\n      func = sys.__findVar(func, null) // 文字列指定なら関数に変換\n      work.onoutput = (data, e) => {\n        sys.__v0['受信データ'] = data\n        sys.__v0['対象イベント'] = e\n        return func(e, sys)\n      }\n    },\n    return_none: true\n  },\n  'ワーカーメッセージ受信時': { // @無名関数Fでworkに対してメッセージを受信した時に実行するイベントを設定。『受信データ』に受信したデータ。『対象イベント』にイベント引数。 // @わーかーめっせーじじゅしんしたとき\n    type: 'func',\n    josi: [['で'], ['から']],\n    isVariableJosi: true,\n    pure: false,\n    fn: function (func, work, sys) {\n      if (typeof sys === 'undefined') { sys = work; work = self }\n      func = sys.__findVar(func, null) // 文字列指定なら関数に変換\n      work.onmessage = (e) => {\n        sys.__v0['受信データ'] = e.data\n        sys.__v0['対象イベント'] = e\n        return func(e, sys)\n      }\n    },\n    return_none: true\n  },\n  'NAKOワーカープログラム起動': { // @WORKERに固有の形式でプログラムの転送と実行行う。 // @NAKOわーかーぷろぐらむきどう\n    type: 'func',\n    josi: [['に', 'で'], ['を']],\n    pure: true,\n    fn: function (work, data, sys) {\n      const msg = {\n        type: 'run',\n        data: data\n      }\n      work.postMessage(msg)\n    },\n    return_none: true\n  },\n  'NAKOワーカーリセット': { // @WORKERに固有の形式でプログラムの転送と実行行う。 // @わーかーりせっと\n    type: 'func',\n    josi: [['を']],\n    pure: true,\n    fn: function (work, sys) {\n      const msg = {\n        type: 'reset',\n        data: ''\n      }\n      work.postMessage(msg)\n    },\n    return_none: true\n  },\n  'ワーカー終了': { // @WORKERを終了する。 // @わーかーしゅうりょう\n    type: 'func',\n    josi: [['を']],\n    isVariableJosi: true,\n    pure: true,\n    fn: function (work, sys) {\n      if (typeof sys === 'undefined') { sys = work; work = self }\n      work.terminate()\n    },\n    return_none: true\n  },\n  'NAKOワーカー終了': { // @WORKERを終了する。 // @NAKOわーかーしゅうりょう\n    type: 'func',\n    josi: [['を']],\n    isVariableJosi: true,\n    pure: true,\n    fn: function (work, sys) {\n      if (typeof sys === 'undefined') {\n        self.close()\n        return\n      }\n      const msg = {\n        type: 'close',\n        data: ''\n      }\n      work.postMessage(msg)\n    },\n    return_none: true\n  },\n  'NAKOワーカーデータ送信': { // @WORKERに固有の形式でデータを送信する。 // @NAKOわーかーでーたそうしん\n    type: 'func',\n    josi: [['を'], ['に', 'へ']],\n    isVariableJosi: true,\n    pure: true,\n    fn: function (data, work, sys) {\n      if (typeof sys === 'undefined') { sys = work; work = self }\n      const msg = {\n        type: 'data',\n        data: data\n      }\n      work.postMessage(msg)\n    },\n    return_none: true\n  },\n  'ワーカーメッセージ送信': { // @WORKERにメッセージを送信する。 // @わーかーめっせーじそうしん\n    type: 'func',\n    josi: [['を'], ['に', 'へ']],\n    isVariableJosi: true,\n    pure: true,\n    fn: function (msg, work, sys) {\n      if (typeof sys === 'undefined') { sys = work; work = self }\n      work.postMessage(msg)\n    },\n    return_none: true\n  },\n  'NAKOワーカー転送': { // @WORKERにユーザー定義関数またはユーザ定義のグローバル変数を転送する。 // @NAKOわーかーてんそう\n    type: 'func',\n    josi: [['を'], ['に', 'へ']],\n    isVariableJosi: true,\n    pure: false,\n    fn: function (datas, work, sys) {\n      if (typeof sys === 'undefined') { sys = work; work = self }\n      const modNameList = []\n      const obj = []\n      if (typeof datas === 'string') { datas = [datas] }\n      datas.forEach(data => {\n        if (data.indexOf('__') === -1) {\n          for (const modname of sys.__modList) {\n            const varname = modname + '__' + data\n            if (typeof sys.__varslist[2].get(varname) !== 'undefined' || typeof sys.__varslist[1].get(varname) !== 'undefined') {\n              data = varname\n              break\n            }\n          }\n        }\n        if (data.indexOf('__') > -1) {\n          const modname = data.split('__')[0]\n          if (modNameList.indexOf(modname) === -1) {\n            modNameList.push(modname)\n          }\n        }\n        if (typeof sys.__varslist[2].get(data) !== 'undefined') {\n          obj.push({\n            type: 'val',\n            name: data,\n            content: sys.__varslist[2].get(data)\n          })\n        } else\n        if (typeof sys.__varslist[1].get(data) !== 'undefined') {\n          obj.push({\n            type: 'func',\n            name: data,\n            content: {\n              meta: sys.gen.nakoFuncList[data],\n              func: Object.assign({}, sys.compiler.funclist[data], { fn: null })\n            }\n          })\n        } else {\n          console.error('指定した名前のユーザ関数もしくはグローバル変数がありません:' + data)\n          throw new Error('指定した名前のユーザ関数もしくはグローバル変数がありません:' + data)\n        }\n      })\n      if (obj.length > 0) {\n        const modInfoList = []\n        for (const modname of modNameList) {\n          modInfoList.push({\n            name: modname,\n            export: sys.compiler.moduleExport[modname]\n          })\n        }\n        obj.push({\n          type: 'env',\n          name: 'modlist',\n          content: modInfoList\n        })\n        obj.push({\n          type: 'env',\n          name: 'constPools',\n          content: sys.constPools\n        })\n        obj.push({\n          type: 'env',\n          name: 'constPoolsTemplate',\n          content: sys.constPoolsTemplate\n        })\n        const msg = {\n          type: 'trans',\n          data: obj\n        }\n        work.postMessage(msg)\n      }\n    },\n    return_none: true\n  }\n}\n\nexport default PluginWebWorker\n\nif (typeof (navigator) === 'object' && typeof (navigator.nako3) === 'object') {\n  navigator.nako3.addPluginObject('PluginWebWorker', PluginWebWorker)\n}\n\n"],"names":["PluginWebWorker","type","josi","pure","fn","sys","_webworker","setNakoHandler","work","onmessage","event","data","value","onoutput","apply","ondata","logger","error","noColor","onerror","e","Error","message","onerrormessage","inWorker","WorkerGlobalScope","self","getBaseUrlFromTag","document","pluginName","path","location","pathname","substr","length","paths","split","slice","join","scripts","querySelectorAll","i","src","index","indexOf","substring","origin","test","__v0","url","return_none","Worker","blob","Blob","URL","createObjectURL","isVariableJosi","plugins","undefined","Array","baseurl","code","l","myWorker","func","__findVar","msg","postMessage","terminate","close","datas","modNameList","obj","forEach","modname","__modList","varname","__varslist","get","push","name","content","console","meta","gen","nakoFuncList","Object","assign","compiler","funclist","modInfoList","export","moduleExport","constPools","constPoolsTemplate","navigator","nako3","addPluginObject"],"sourceRoot":""}