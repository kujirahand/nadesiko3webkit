!function(){"use strict";const r={delimiter:",",eol:"\r\n"};function t(t,e){null==e&&(e=r.delimiter),t=(t=(t+="\n").replace(/(\r\n|\r)/g,"\n")).replace(/\s+$/,"")+"\n";for(var s=new RegExp("^(.*?)([\\"+e+"\\n])"),n=function(r){return"string"==typeof r&&r.search(/^[0-9\.]+$/)>=0&&(r=parseFloat(r)),r},i=[],o=[],u="";""!=t;)if((u=t.charAt(0))!==e)if("\n"!==u)if((u=(t=t.replace(/^\s+/,"")).charAt(0))!==e)if("="!==u||'"'!==t.charAt(1))if('"'===u)if('""'!=t.substring(0,2)){for(var l=1,h="";l<t.length;){var a=t.charAt(l),f=t.charAt(l+1);if('"'!=a||'"'!=f)if('"'!=a)h+=a,l++;else{if(l++,f==e){l++,o.push(n(h)),h="";break}if("\n"==f){l++,o.push(n(h)),i.push(o),o=[];break}l++}else l+=2,h+='"'}t=t.substr(l)}else o.push(""),t=t.substring(2);else{var p=s.exec(t);if(!p){o.push(n(t)),i.push(o),o=[];break}"\n"==p[2]?(o.push(n(p[1])),i.push(o),o=[]):p[2]==e&&o.push(n(p[1])),t=t.substring(p[0].length)}else t=t.substring(1);else console.log("delimiter"),o.push(""),t=t.substring(e.length);else o.push(""),i.push(o),o=[],t=t.substring(1);else t=t.substring(1),o.push("");return o.length>0&&i.push(o),i}function e(t,e,s){null==e&&(e=r.delimiter),null==s&&(s=r.eol);var n=function(r,t){return function(t){var e=!1;return((t=""+t).indexOf("\n")>=0||t.indexOf("\r")>=0)&&(e=!0),t.indexOf(r)>=0&&(e=!0),t.indexOf('"')>=0&&(e=!0,t=t.replace(/\"/g,'""')),e&&(t='"'+t+'"'),t}}(e);if(null==t)return"";for(var i="",o=0;o<t.length;o++){var u=t[o];if(null!=u){for(var l=0;l<u.length;l++)u[l]=n(u[l]);i+=u.join(e)+s}else i+=s}return i=i.replace(/(\r\n|\r|\n)/g,s)}var s={resetEnv:function(){r.delimiter=",",r.eol="\r\n"},parse:t,stringify:e,options:r,CSVObject:class{constructor(t){this.rows=[],this.options=t||r,this.useHeader=!1}toString(){var r=this.options.delimiter,t=this.options.eol;return e(this.rows,r,t)}parse(r,e){this.rows=t(r,e)}fromString(r,t){this.parse(r,t)}stringify(){return this.toString()}getCell(r,t){return this.rows[r][t]}setCell(r,t,e){for(var s=this.getColSize();this.rows.length<=r;){for(var n=[],i=0;i<s;i++)n.push("");this.rows.push(n)}this.rows[r][t]=e}getColSize(){return 0==this.rows.length?0:this.rows[0].length}setArray(r){this.rows=r}getArray(){return this.rows}getRowValues(r){return r>=this.rows.length?[]:this.rows[r]}getColValues(r){var t=[];for(var e in this.rows){var s=this.rows[e];t.push(s[r])}return t}find(r,t,e){null==e&&(e=this.useHeader?1:0);for(var s=e;s<this.rows.length;s++){if(this.rows[s][r]==t)return s}return-1}findAll(r,t,e,s){const n=[];null==e&&(e=this.useHeader?1:0),null==s&&(s=this.rows.length);for(var i=e;i<this.rows.length;i++){var o=this.rows[i];if(o[r]==t&&(n.push(o),s<=n.length))break}return n}filter(r,t){return this.rows.filter((function(e,s,n){if(null==e)return!1;var i=e[r];return t(i,s,n)}))}sort(r,t){var e;if(null==t&&(t=!0),e=t?function(t,e){return t[r]>e[r]?1:-1}:function(t,e){return t[r]<e[r]?1:-1},this.useHeader){const r=this.rows.shift();this.rows.sort(e),r&&this.rows.unshift(r)}else this.rows.sort(e)}sortNumber(r,t){var e;if(null==t&&(t=!0),e=t?function(t,e){return parseFloat(t[r])-parseFloat(e[r])}:function(t,e){return parseFloat(e[r])-parseFloat(t[r])},this.useHeader){var s=this.rows.shift();this.rows.sort(e),s&&this.rows.unshift(s)}else this.rows.sort(e)}insertRow(r,t){return this.rows.splice(r,0,t)}insert(r,t){return this.insertRow(r,t)}add(r){this.rows.push(r)}deleteRow(r){return this.rows.splice(r,1)}insertCol(r,t){this.rows.map((function(e,s,n){return e.splice(r,0,t[s]),e}))}deleteCol(r){this.rows.map((function(t,e,s){return t.splice(r,1),t}))}get length(){return this.rows.length}},replaceEolMark:function(r){return r=(r=(r=r.replace(/\n\r/g,"[CRLF]")).replace(/\r/g,"[CR]")).replace(/\n/g,"[LF]")},CRLF:"\r\n",CR:"\r",LF:"\n"};const n={"初期化":{type:"func",josi:[],pure:!0,fn:function(){s.resetEnv()}},"CSV取得":{type:"func",josi:[["を","の","で"]],pure:!0,fn:function(r){return s.options.delimiter=",",s.parse(r)}},"TSV取得":{type:"func",josi:[["を","の","で"]],pure:!0,fn:function(r){return s.options.delimiter="\t",s.parse(r)}},"表CSV変換":{type:"func",josi:[["を"]],pure:!0,fn:function(r){return s.options.delimiter=",",s.stringify(r)}},"表TSV変換":{type:"func",josi:[["を"]],pure:!0,fn:function(r){return s.options.delimiter="\t",s.stringify(r)}}};"object"==typeof navigator&&"object"==typeof navigator.nako3&&navigator.nako3.addPluginObject("PluginCSV",n)}();